installCRDs: true

deployNodeAgent: true

configuration:
  backupStorageLocation:
    - name: default
      provider: aws
      bucket: "recomend-backups"
      config:
        region: auto
        s3ForcePathStyle: "true"
        s3Url: "https://c960e9a51b5b0decbfee92d753e153b0.r2.cloudflarestorage.com"

  volumeSnapshotLocation:
    - name: default
      provider: aws
      config:
        region: auto

  defaultVolumesToFsBackup: false

credentials:
  useSecret: true
  existingSecret: velero-credentials

initContainers:
  - name: velero-plugin-for-aws
    image: velero/velero-plugin-for-aws:v1.10.0
    volumeMounts:
      - mountPath: /target
        name: plugins

nodeAgent:
  podVolumePath: /var/lib/kubelet/pods
  privileged: false
  tolerations:
    - effect: NoSchedule
      operator: Exists
  resources:
    requests:
      memory: 200Mi
      cpu: 500m
    limits:
      memory: 1Gi
      cpu: 1000m

# Schedule de backup quotidien
schedules:
  daily:
    disabled: false
    schedule: "0 2 * * *"  # 2h du matin
    useOwnerReferencesInBackup: false
    template:
      ttl: "720h"  # 30 jours
      includedNamespaces:
        - "*"
      excludedNamespaces:
        - velero
      defaultVolumesToFsBackup: true  # Backup des volumes dans le schedule